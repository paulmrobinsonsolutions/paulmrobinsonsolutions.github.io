<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PowerApps by Paul</title>  
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap JS (optional, for interactive components) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link href=".\css\style.css" rel="stylesheet">
</head>
<body>
<div class="row">
    <div class="col-4">
        <nav id="navbarContent" class="h-100 flex-column align-items-stretch pe-4 border-end">
            <a class="nav-link subHeader" href="#item-1">File Upload Form</a>
            <nav class="nav nav-pills flex-column">
                <a class="nav-link ms-3 my-1" href="#item-1-1">1.1 - The Form User Interface</a>
                <a class="nav-link ms-3 my-1" href="#item-1-2">1.2 - File Type Validation Logic</a>
                <a class="nav-link ms-3 my-1" href="#item-1-3">1.3 - Upload Validation and User Feedback</a>
            </nav>
            <a class="nav-link subHeader" href="#item-2">Power Automate Flow</a>
            <nav class="nav nav-pills flex-column">
                <a class="nav-link ms-3 my-1" href="#item-2-1">2.1 - Power Automate Flow Parameters</a>
                <a class="nav-link ms-3 my-1" href="#item-2-2">2.2 - Dynamic Generation of File Name Logic</a>
                <a class="nav-link ms-3 my-1" href="#item-2-3">2.3 - SharePoint File Path Concatenation</a>
                <a class="nav-link ms-3 my-1" href="#item-2-4">2.4 - Success Status Code Check</a>
                <a class="nav-link ms-3 my-1" href="#item-2-4">2.5 - Logic to Return Success/Failure Reponse</a>
            </nav>
            <a class="nav-link appDescriptor" href="#">
                Power Apps - File Upload Form
            </a>
            <nav class="nav nav-pills flex-column">
            <p>This Power Apps form was designed to enable users to quickly and easily upload input files for their respective
            automated processes. This form was intended to hide the complexities of navigating directly to a SharePoint site
            then into the respective folder where input files would then be picked up by an automation platform.
            </p>
            <p>
            *Note that Business Areas could perform cross-functional duties so row-level security was not implemented. This
            enabled teams to easily work together in support of each other with uploading input files for their respective
            automated processes.
            </p>
            </nav>
        </nav>
    </div>

  <div class="col-8">
    <div data-bs-spy="scroll" data-bs-target="#navbarContent" data-bs-smooth-scroll="true" class="scrollspy-example-2 mainWindow" tabindex="0">
      <div id="item-1" style="border-bottom: 1px solid lightsteelblue;">
        <h4>File Upload Form</h4>
      </div>
      <div id="item-1-1">
        <p>1.1 - This shows the user interface form that enabled input file uploads for the respective Business Area and
            automated process. Note that the two list options are pulled in from a SharePoint list which decoupled these
            list options from the form and allows for easy management by any authorized person.
        </p>
        <p><img src="https://github.com/paulmrobinsonsolutions/PowerApp_FileUpload/blob/main/img/PowerApps1-FileUploadForm.png?raw=true" height="500"></p>
      </div>
      <div id="item-1-2">
        <p>1.2 - This outlines the DAX logic to validate / restrict selected file types. Note that this happens upon file 
            selection so there is immediate feedback to the user if an invalid file type was selected.
        </p>
        <p><img src="https://github.com/paulmrobinsonsolutions/PowerApp_FileUpload/blob/main/img/PowerApps2-FileAttachedLogic.png?raw=true" height="425"></p>
      </div>
      <div id="item-1-3">
        <p>1.3 - This outlines the file upload DAX logic when clicking the "Import" button. There is some basic validation
            (because you can never too sure), feedback to the user and then the files selected are cleared to ensure the
            file(s) are not uploaded again. Note that the Power Automate flow will also return a success/failure response.
        </p>
        <p><img src="https://github.com/paulmrobinsonsolutions/PowerApp_FileUpload/blob/main/img/PowerApps3-FileUploadButtonLogic.png?raw=true" height="500"></p>
      </div>
      <div id="item-2"style="border-bottom: 1px solid lightsteelblue; border-top: 1px solid lightsteelblue;">
        <h4>Power Automate Flow</h4>
      </div>
      <div id="item-2-1">
        <p>2.1 - The first action in the Power Automate flow is the trigger that takes in the input parameters.</p>
        <p><img src="https://github.com/paulmrobinsonsolutions/PowerApp_FileUpload/blob/main/img/PowerAutomate1-FlowInput.png?raw=true" height="500"></p>
      </div>
      <div id="item-2-2">
        <p>2.2 - This action generates the name of the file as it's name when saved to SharePoint. This dynamically
            calcuates and inserts a date and time formatted string to ensure duplicate file names are not created which
            also ensure files do not get overwritten with the same file name. This also serves as an indicator to easily
            identify the respective file name in the event something bad happens and troubleshooting is needed.
        </p>
        <p><img src="https://github.com/paulmrobinsonsolutions/PowerApp_FileUpload/blob/main/img/PowerAutomate2-CreateNewFileName.png?raw=true" height="500"></p>
      </div>
      <div id="item-2-3">
        <p>2.3 - This action concatenates the input parameters along with a predefined SharePoint root path to save the
            uploaded file to the intended SharePoint process folder. This action physically creates the file in SharePoint.
        </p>
        <p><img src="https://github.com/paulmrobinsonsolutions/PowerApp_FileUpload/blob/main/img/PowerAutomate3-SaveFileToSharePoint.png?raw=true" height="500"></p>
      </div>
      <div id="item-2-4">
        <p>2.4 - This action gets the result status code from the previous "save" action and stores it in a local variable
            for later analysis. Just like the second action in this, this also serves as a way to easily identify whether
            or not a file was successfully saved.
        </p>
        <p><img src="https://github.com/paulmrobinsonsolutions/PowerApp_FileUpload/blob/main/img/PowerAutomate4-CaptureFileUploadSavedStatus.png?raw=true" height="500"></p>
      </div>
      <div id="item-2-5">
        <p>2.5 - Finally the status code is evaluated and a simple true/false "success" flag is returned to be evaluated
            by the calling form.
        </p>
        <p><img src="https://github.com/paulmrobinsonsolutions/PowerApp_FileUpload/blob/main/img/PowerAutomate5-ReturnWasSavedStatusCode.png?raw=true" height="500"></p>
      </div>
    </div>
  </div>
</div>

</body>
</html>